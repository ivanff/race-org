<ActionBar [title]="'Athlets'|L">
    <NavigationButton icon="res://round_menu_black_24"
                      (tap)="onDrawerButtonTap()"></NavigationButton>
</ActionBar>
<GridLayout rows="auto, auto, *" columns="*">
    <StackLayout row="0" col="0">
        <SearchBar [hint]="'Search by Full name'|L" [text]="searchPhrase"
                   (textChange)="onTextChanged($event)"
                   (submit)="onSubmit($event)"
                   (loaded)="searchBarLoaded($event)"></SearchBar>
    </StackLayout>
    <StackLayout row="1" col="0">
        <GridLayout rows="*" columns="*, auto">
            <Button [text]="activityIndicator.busy ? ('Остановить поиск'|L) :('Найти по метке NFC'|L) "
                    (tap)="(activityIndicator.busy = !activityIndicator.busy)"
                    [class.btn-primary]="!activityIndicator.busy"
                    row="0"
                    col="0"
                    class="btn btn-active">
            </Button>
            <ActivityIndicator row="0"
                               col="1"
                               height="20"
                               width="20"
                               #activityIndicator
                               (busyChange)="onBusyChanged($event)"
                               style="color: red;"
                               verticalAlignment="center"
                               horizontalAlignment="center"
                               class="activity-indicator m-15"></ActivityIndicator>
        </GridLayout>
    </StackLayout>

    <ScrollView row="2" col="0">
        <ListView height="100%"
                  [items]="athlets|filter:'fio':searchPhrase"
                  (itemTap)="onItemTap($event)">
            <ng-template let-athlet="item" let-i="index" let-odd="odd" let-even="even">
                <StackLayout class="p-l-5 p-r-5">
                    <Label class="title">
                        <FormattedString>
                            <Span [text]="athlet.number + ':  '" style="font-weight: bold; font-size: 15em"></Span>
                            <Span [text]="athlet.fio"></Span>
                        </FormattedString>
                    </Label>
                    <FlexboxLayout flexDirection="row">
                        <Label [text]="athlet.city + '; '" class="info"></Label>
                        <Label [text]="athlet.bike + '; '" class="info"></Label>
                        <Label [text]="'назначено' ? athlet.nfc_id : 'не назначено'" class="info"
                               style="color: red; font-weight: bold"></Label>
                    </FlexboxLayout>
                    <Label *ngIf="athlet.checkpoints"
                           [text]="'Пройдено отметок: ' + athlet.checkpoints.length"
                           class="info"></Label>
                </StackLayout>
            </ng-template>
        </ListView>
    </ScrollView>
</GridLayout>
