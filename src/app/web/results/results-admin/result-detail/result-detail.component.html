<ul>
    <li>
        {{athlet.fio}}
    </li>
    <li>
        <b>{{athlet.number}}</b>
    </li>
    <li>
        {{athlet.nfc_id}}
    </li>
    <li>
        г. {{athlet.city}}
    </li>
    <li>
        тел. {{athlet.phone}}
    </li>
    <li>
        Класс {{athlet.class}}
    </li>
</ul>

<button mat-stroked-button
        color="primary"
        (click)="onAddTime()">
    Добавить время
</button>
<br>

<!--{{ athlet.checkpoints|json }}-->

<!--{{checkpoints|json}}-->

<table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">

    <ng-container matColumnDef="cp">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Checkpoint</th>
        <td mat-cell *matCellDef="let element"> {{ element.checkpoint.key }} </td>
    </ng-container>

    <ng-container matColumnDef="nfc">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> NFC отметка времени.</th>
        <td mat-cell *matCellDef="let element"
            [class.active]="element.mark?.manual && !element.mark?.missing">
            {{ element.mark?.created?.toDate()|date:"HH:mm:ss" }}
        </td>
    </ng-container>

    <ng-container matColumnDef="nfc_cp_offset">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> время до предыдущей отметки.</th>
        <td mat-cell *matCellDef="let element; let i = index">
            {{ diffTime(dataSource.data[i-1]?.mark?.created, element.mark?.created) }}
        </td>
    </ng-container>

    <ng-container matColumnDef="local">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Local отметка времени.</th>
        <td mat-cell *matCellDef="let element">
            {{ element.local?.created?.toDate()|date:"HH:mm:ss" }}
        </td>
    </ng-container>
    <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>
            <button mat-stroked-button color="warn" (click)="onSave()">
                Сохранить
            </button>
        </th>
        <td mat-cell *matCellDef="let element; let i = index">
            <button mat-stroked-button
                    color="primary"
                    (click)="onSetTime(i)"
                    [disabled]="!element.mark?.missing && !element.mark?.manual">
                Установить время
            </button>
            <button mat-stroked-button
                    color="primary"
                    (click)="onDeleteTime(i)"
                    [disabled]="!element.mark?.created">
                Удалить
            </button>
        </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns; let i = index;"
        [class.last-cp]="isLastCp(i)"></tr>
</table>
