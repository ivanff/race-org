<div class="p-20">
    <button (click)="onStart($event)" mat-raised-button color="primary">Начать соревнования</button>
</div>
<div class="p-20">
    <ngx-timepicker-field #picker
                          [format]="24"
                          [defaultTime]="start_time.format('HH:mm')"></ngx-timepicker-field>
</div>

<mat-form-field class="p-20">
    <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Фильтр">
</mat-form-field>

<table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">
    <ng-container matColumnDef="place">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Place</th>
        <td mat-cell *matCellDef="let element" [class.highlight]="element.place <= 3"> {{ element.place }} </td>
    </ng-container>

    <ng-container matColumnDef="number">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> No.</th>
        <td mat-cell *matCellDef="let element"> {{element.number}} </td>
    </ng-container>

    <ng-container matColumnDef="athlet">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Athlet</th>
        <td mat-cell *matCellDef="let element">
          <span>
             {{element.athlet.fio}}
          </span><br>
            <small>
                {{element.athlet.bike}}
            </small><br>
            <small>
                г. {{element.athlet.city}}
            </small>
            <small>
                тел. {{element.athlet.phone}}
            </small>
        </td>
    </ng-container>

    <ng-container [matColumnDef]="def.key + '_' + y" *ngFor="let def of checkpoints; let y = index;">
        <th mat-header-cell *matHeaderCellDef>
        <span>
            {{ def.key }}
        </span><br>
            <small>
                {{ def.name }}
            </small>
        </th>
        <td mat-cell *matCellDef="let element" [ngSwitch]="element.marks[y]">
      <span *ngSwitchDefault [class.active]="element.last_created == element.marks[y].created">
        <mat-icon aria-hidden="false" aria-label="Clock">av_timer</mat-icon>{{ diffTime(element.marks[y].created) }}<br>
        <small>
            {{ element.marks[y].created.toDate()|date:"dd.MM HH:mm:ss" }}<br>
        </small>
      </span>
            <span *ngSwitchCase="null">-</span>
        </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
</table>
